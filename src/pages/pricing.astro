---
import Button from '@/shared/components/Button.astro'
import Footer from '@/shared/components/Footer.astro'
import Nav from '@/shared/components/Nav.astro'
import Check from '@/shared/components/icons/Check.astro'
import Layout from '@/shared/layouts/Layout.astro'
---

<Layout
  title='Gadmin - Planes y precios'
  description='Descubre los planes que Gadmin tiene para ti y empieza tu tienda online hoy mismo desde $4.99 al mes.'
>
  <Nav />
  <div class='pricing'>
    <div class='wrapper'>
      <p class='pricing__section-name'>Precios</p>
      <h1 class='pricing__title'>Planes para negocios de todos los tama침os</h1>
      <h2 class='pricing__subtitle'>
        Elija un plan asequible que incluya las mejores funciones para su tienda.
      </h2>
      <div class='pricing__tabs'>
        <div class='pricing__tab' data-tab='monthly'>Mensual</div>
        <div class='pricing__tab pricing__tab--selected' data-tab='yearly'>Anual (-30%)</div>
        <div class='pricing__tabs-background'></div>
      </div>
      <div class='pricing__cards-container'>
        <div class='pricing__cards'>
          <div class='pricing__card'>
            <h3 class='pricing__card-name'>Bronce 游밽</h3>
            <p class='pricing__card-description'>
              El mejor plan para tiendas de 1 solo producto o peque침os nichos.
            </p>
            <div class='pricing__card-price'>
              <div id='price-bronze' class='pricing__card-price-value'>$3.49</div>
              <div class='pricing__card-price-billing'>/mes</div>
            </div>
            <div class='pricing__card-price-helper'>
              Total: <span id='price-bronze-total'>$41.91</span> pagado anualmente.
            </div>
            <Button mode='default' type='gray' href='#!' target='_blank'
              >Inicia prueba de 14 d칤as gratis</Button
            >
            <div class='pricing__features'>
              <div class='pricing__feature'>
                <Check size={24} />
                <p class='pricing__feature-text'>Ventas ilimitadas sin comisi칩n</p>
              </div>
              <div class='pricing__feature'>
                <Check size={24} />
                <p class='pricing__feature-text'>Hasta 30 productos</p>
              </div>
              <div class='pricing__feature'>
                <Check size={24} />
                <p class='pricing__feature-text'>3 im치genes por producto</p>
              </div>
              <div class='pricing__feature'>
                <Check size={24} />
                <p class='pricing__feature-text'>5 variantes por producto</p>
              </div>
            </div>
          </div>
          <div class='pricing__card pricing__card--silver'>
            <div class='pricing__card-badge'>Recomendado</div>
            <h3 class='pricing__card-name'>Plata 游뽔</h3>
            <p class='pricing__card-description'>El mejor plan para tiendas de nicho.</p>
            <div class='pricing__card-price'>
              <div id='price-silver' class='pricing__card-price-value'>$10.49</div>
              <div class='pricing__card-price-billing'>/mes</div>
            </div>
            <div class='pricing__card-price-helper'>
              Total: <span id='price-silver-total'>$125.91</span> pagado anualmente.
            </div>
            <Button mode='default' href='#!' target='_blank'>Inicia prueba de 14 d칤as gratis</Button
            >
            <div class='pricing__features'>
              <div class='pricing__feature'>
                <Check size={24} color='#ffffff' />
                <p class='pricing__feature-text'>Hasta 100 productos</p>
              </div>
              <div class='pricing__feature'>
                <Check size={24} color='#ffffff' />
                <p class='pricing__feature-text'>10 im치genes por producto</p>
              </div>
              <div class='pricing__feature'>
                <Check size={24} color='#ffffff' />
                <p class='pricing__feature-text'>Variantes ilimitadas</p>
              </div>
              <div class='pricing__feature'>
                <Check size={24} color='#ffffff' />
                <p class='pricing__feature-text'>Dominio personalizado</p>
              </div>
              <div class='pricing__feature'>
                <Check size={24} color='#ffffff' />
                <p class='pricing__feature-text'>Multilenguaje y multimonedas</p>
              </div>
            </div>
          </div>
          <div class='pricing__card'>
            <h3 class='pricing__card-name'>Oro 游눝</h3>
            <p class='pricing__card-description'>
              Para tiendas con una gran cantidad de productos y clientes.
            </p>

            <div class='pricing__card-price'>
              <div id='price-gold' class='pricing__card-price-value'>$20.30</div>
              <div class='pricing__card-price-billing'>/mes</div>
            </div>
            <div class='pricing__card-price-helper'>
              Total: <span id='price-gold-total'>$243.60</span> pagado anualmente.
            </div>
            <Button mode='default' type='gray' href='#!' target='_blank'
              >Inicia prueba de 14 d칤as gratis</Button
            >
            <div class='pricing__features'>
              <div class='pricing__feature'>
                <Check size={24} />
                <p class='pricing__feature-text'>Ventas ilimitadas sin comisi칩n</p>
              </div>
              <div class='pricing__feature'>
                <Check size={24} />
                <p class='pricing__feature-text'>Productos ilimitados</p>
              </div>
              <div class='pricing__feature'>
                <Check size={24} />
                <p class='pricing__feature-text'>20 im치genes por producto</p>
              </div>
              <div class='pricing__feature'>
                <Check size={24} />
                <p class='pricing__feature-text'>Variantes ilimitadas</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <Footer />
</Layout>

<style>
  .pricing {
    background-color: #0eaaf9;
    background-image: linear-gradient(135deg, #01283c, #0b321c);
    min-height: calc(100svh - 6rem);
    padding-top: 10rem;
    padding-bottom: 4rem;
  }

  .pricing__section-name {
    text-align: center;
    color: var(--primary);
    font-size: var(--32-pt);
    font-weight: bold;
    margin: 0;
  }

  .pricing__title {
    text-align: center;
    color: white;
    font-size: var(--48-pt);
    margin: 1rem 0;
  }

  .pricing__subtitle {
    text-align: center;
    font-size: var(--32-pt);
    font-weight: 500;
    margin: 2rem;
    color: var(--primary-3);
  }

  .pricing__tabs {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    background-color: var(--white);
    padding: 1rem;
    border-radius: 1rem;
    width: fit-content;
    margin: 0 auto;
    position: relative;
  }

  .pricing__tab {
    padding: 0.75rem 1rem;
    background-color: transparent;
    border-radius: 0.5rem;
    font-weight: bold;
    position: relative;
    z-index: 1;
    transition: 0.2s ease color;
    cursor: default;
  }

  .pricing__tab:hover:not(.pricing__tab--selected) {
    color: var(--shade-04);
  }

  .pricing__tabs-background {
    position: absolute;
    top: 0;
    left: 0;
    background-image: linear-gradient(to right, var(--primary), var(--secondary));
    border-radius: 0.5rem;
    transition:
      width 0.3s ease,
      transform 0.3s ease;
  }

  .pricing__cards-container {
    padding: 1rem;
  }

  .pricing__cards {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    align-items: flex-end;
    gap: 1.5rem;
    margin-top: 4rem;
    background-color: var(--white);
    padding: 1rem;
    border-radius: 1rem;
  }

  .pricing__card-badge {
    text-transform: uppercase;
    background-color: #52d689;
    padding: 0.5rem 1rem;
    border-radius: 1rem;
    width: fit-content;
    margin: 0 0 0 auto;
    font-weight: bold;
    font-size: 0.7rem;
  }

  .pricing__card {
    padding: 1rem 2rem;
    border-radius: 1rem;
  }

  .pricing__card-name {
    margin: 0.5rem 0;
    font-size: var(--32-pt);
    color: var(--shade-03);
  }

  .pricing__card-description {
    margin: 0.5rem 0;
    color: var(--neutral-08);
  }

  .pricing__card-price {
    display: flex;
    align-items: center;
    margin: 0;
    margin-top: 1.5rem;
    gap: 0.5rem;
  }

  .pricing__card-price-value {
    font-size: var(--40-pt);
    font-weight: bold;
    color: var(--shade-03);
  }

  .pricing__card-price-billing {
    color: var(--neutral-08);
  }

  .pricing__card-price-helper {
    margin: 0;
    padding-bottom: 1.5rem;
    color: var(--neutral-08);
    transition:
      0.2s ease opacity,
      0.2s ease padding-bottom;
  }

  .pricing__card--silver {
    position: relative;
    top: 0rem;
    background-color: var(--shade-03);
    height: calc(100% + 0.5rem);
  }

  .pricing__card--silver .pricing__card-name {
    color: var(--white);
  }

  .pricing__card--silver .pricing__card-description {
    color: var(--neutral-03);
  }

  .pricing__card--silver .pricing__card-price-value {
    color: var(--neutral-02);
  }

  .pricing__card--silver .pricing__card-price-billing {
    color: var(--neutral-03);
  }

  .pricing__card--silver .pricing__card-price-helper {
    color: var(--neutral-03);
  }

  .pricing__cards--monthly .pricing__card-price-helper {
    opacity: 0;
    padding-bottom: 0.5rem;
  }

  .pricing__features {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-top: 1.5rem;
  }

  .pricing__feature {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .pricing__feature-text {
    margin: 0;
  }

  .pricing__card--silver .pricing__feature-text {
    color: var(--neutral-02);
  }

  @media screen and (max-width: 768px) {
    .pricing {
      padding-top: 6rem;
    }

    .pricing__cards-container {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .pricing__cards {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin: 1rem;
      margin-top: 2rem;
      width: fit-content;
    }

    .pricing__card {
      padding: 1rem;
      width: 100%;
      max-width: 420px;
      margin: 0 auto;
    }

    .pricing__card--silver {
      height: fit-content;
    }
  }
</style>

<script>
  import { pricingByBilling } from '../web/data/pricing'

  const initBillingTabs = () => {
    const billingTabs = document.querySelectorAll('.pricing__tab')

    const changeBillingType = (target: HTMLElement) => {
      billingTabs.forEach((billingTab) => billingTab.classList.remove('pricing__tab--selected'))

      const background = document.querySelector('.pricing__tabs-background')
      if (target instanceof HTMLElement && background instanceof HTMLElement) {
        target.classList.add('pricing__tab--selected')

        // * Animate background of tab
        const [tabWidth, tabHeight] = [target.offsetWidth, target.offsetHeight]
        const [tabLeft, tabTop] = [target.offsetLeft, target.offsetTop]

        background.style.width = tabWidth + 'px'
        background.style.height = tabHeight + 'px'
        background.style.transform = `translate(${tabLeft}px, ${tabTop}px)`

        // * Modify Pricing Data
        const billingType = target?.dataset?.tab as 'monthly' | 'yearly'
        const pricing = pricingByBilling[billingType]

        const pricingCards = document.querySelector('.pricing__cards')
        if (pricingCards) {
          pricingCards.classList.remove('pricing__cards--monthly')
          pricingCards.classList.remove('pricing__cards--yearly')
          pricingCards.classList.add(`pricing__cards--${billingType}`)
        }

        // * Bronze
        const bronzePrice = document.getElementById('price-bronze')
        const bronzeTotalPrice = document.getElementById('price-bronze-total')

        if (bronzePrice && bronzeTotalPrice) {
          bronzePrice.innerText = `$${pricing.bronze.price.toFixed(2)}`
          bronzeTotalPrice.innerText = `$${(pricing.bronze.price * 12).toFixed(2)}`
        }

        // * Silver
        const silverPrice = document.getElementById('price-silver')
        const silverTotalPrice = document.getElementById('price-silver-total')

        if (silverPrice && silverTotalPrice) {
          silverPrice.innerText = `$${pricing.silver.price.toFixed(2)}`
          silverTotalPrice.innerText = `$${(pricing.silver.price * 12).toFixed(2)}`
        }

        // * Gold
        const goldPrice = document.getElementById('price-gold')
        const goldTotalPrice = document.getElementById('price-gold-total')

        if (goldPrice && goldTotalPrice) {
          goldPrice.innerText = `$${pricing.gold.price.toFixed(2)}`
          goldTotalPrice.innerText = `$${(pricing.gold.price * 12).toFixed(2)}`
        }
      }
    }

    billingTabs.forEach((tab) => {
      tab.addEventListener('click', (ev) => {
        changeBillingType(ev.target as HTMLElement)
      })
    })

    const selectedTab = document.querySelector('.pricing__tab--selected')
    if (selectedTab) {
      changeBillingType(selectedTab as HTMLElement)
    }
  }

  document.addEventListener('DOMContentLoaded', initBillingTabs)
  document.addEventListener('astro:after-swap', initBillingTabs)
</script>
